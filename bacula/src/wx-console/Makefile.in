#
#  Version $Id$
#
@MCOMMON@

srcdir =	.
VPATH = 	.
.PATH:		.

# one up
basedir = ..
# top dir
topdir = ../..
# this dir relative to top dir
thisdir = src/wx-console

DEBUG=@DEBUG@

first_rule: all
dummy:

#
CONSSRCS = main.cpp console_thread.cpp authenticate.c console_conf.c wxbrestorepanel.cpp \
	     wxbmainframe.cpp wxbtableparser.cpp wxbtreectrl.cpp
CONSOBJS = main.o console_thread.o authenticate.o console_conf.o wxbrestorepanel.o \
	     wxbmainframe.o wxbtableparser.o wxbtreectrl.o

@if test "@DISTNAME@" = "cygwin" then \
RES = wx-console_private.res; \
else \
RES = ;\
fi

# these are the objects that are changed by the .configure process
EXTRAOBJS = @OBJLIST@

CONS_INC=
CONS_LIBS=

# wx-config generated by configure
CONS_CPPFLAGS=@WXCONS_CPPFLAGS@
CONS_LDFLAGS=@WXCONS_LDFLAGS@

.SUFFIXES:     .cpp .c .o
.PHONY:
.DONTCARE:

# inference rules
.c.o:
	$(CXX) $(DEFS) $(DEBUG) -c $(CPPFLAGS) $(CONS_CPPFLAGS) $(CONS_INC) -I$(srcdir) \
	   -I$(basedir) $(DINCLUDE) $(WCFLAGS) $(CFLAGS) $<

.cpp.o:
	$(CXX) $(DEFS) $(DEBUG) -c $(CPPFLAGS) $(CONS_CPPFLAGS) $(CONS_INC) -I$(srcdir) \
	   -I$(basedir) $(DINCLUDE) $(WCFLAGS) $(CFLAGS) $<


#-------------------------------------------------------------------------
all: Makefile wx-console
	@echo "==== Make of wx-console is good ===="
	@echo " "


wx-console: $(CONSOBJS) $(RES) ../lib/libbac.a
	$(CXX) $(CONSOBJS) $(RES) -o $@ $(LIBS) -L../lib $(CONS_LDFLAGS) -lbac
	
wx-console_private.res: wx-console_private.rc 
	windres.exe -i wx-console_private.rc -I rc -o wx-console_private.res -O coff 

clean:
	@$(RMF) $(OBJ) wx-console

distclean: clean
	$(RMF) Makefile
	$(RMF) -r CVS

Makefile: $(srcdir)/Makefile.in $(topdir)/config.status
	cd $(topdir) \
	  && CONFIG_FILES=$(thisdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status

# Semi-automatic generation of dependencies:
# Use gcc -MM because X11 `makedepend' doesn't work on all systems
# and it also includes system headers.
# `semi'-automatic since dependencies are generated at distribution time.

depend:
	@$(MV) Makefile Makefile.bak
	@$(SED) "/^# DO NOT DELETE:/,$$ d" Makefile.bak > Makefile
	@$(ECHO) "# DO NOT DELETE: nice dependency list follows" >> Makefile
	@$(CC) -S -M $(CPPFLAGS) $(CONS_CPPFLAGS) -I$(srcdir) -I$(basedir) $(CONSSRCS) >> Makefile
	@if test -f Makefile ; then \
	    $(RMF) Makefile.bak; \
	else \
	   $(MV) Makefile.bak Makefile; \
	   echo -e "Something went wrong\n\a"; \
	fi

# -----------------------------------------------------------------------
# DO NOT DELETE: nice dependency list follows
