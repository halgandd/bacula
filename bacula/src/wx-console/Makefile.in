#
#  Version $Id$
#
@MCOMMON@

srcdir =	.
VPATH = 	.
.PATH:		.

# one up
basedir = ..
# top dir
topdir = ../..
# this dir relative to top dir
thisdir = src/wx-console

DEBUG=@DEBUG@

first_rule: all
dummy:

#
CONSSRCS = main.c console_thread.c authenticate.c console_conf.c wxbrestorepanel.c \
             wxbmainframe.c wxbtableparser.c
CONSOBJS = main.o console_thread.o authenticate.o console_conf.o wxbrestorepanel.o \
             wxbmainframe.o wxbtableparser.o

@if test "@DISTNAME@" = "cygwin" then \
CONSSRCS = $(CONSSRCS) wx-console_private.rc; \
CONSOBJS = $(CONSOBJS) wx-console_private.res; \
fi

# these are the objects that are changed by the .configure process
EXTRAOBJS = @OBJLIST@

CONS_INC=@CONS_INC@
CONS_LIBS=@CONS_LIBS@

# TODO: wx-config should be generated by configure
CONS_CPPFLAGS=@CONS_CPPFLAGS@ `wx-config --cppflags`
CONS_LDFLAGS=@CONS_LDFLAGS@ `wx-config --libs`

.SUFFIXES:	.c .o
.PHONY:
.DONTCARE:

# inference rules
.c.o:
	$(CXX) $(DEFS) $(DEBUG) -c $(CPPFLAGS) $(CONS_CPPFLAGS) $(CONS_INC) -I$(srcdir) \
	   -I$(basedir) $(DINCLUDE) $(WCFLAGS) $(CFLAGS) $<

#-------------------------------------------------------------------------
all: Makefile wx-console
	@echo "==== Make of wx-console is good ===="
	@echo " "

clean:
	@$(RMF) $(OBJ) wx-console

distclean: clean

wx-console: $(CONSOBJ) ../lib/libbac.a
	$(CXX) $(LINKOBJ) -o wx-console $(LIBS) $(WLDFLAGS) $(CONS_LDFLAGS) -lbac
	
wx-console_private.res: wx-console_private.rc 
	windres.exe -i wx-console_private.rc -I rc -o wx-console_private.res -O coff 